@startuml deployment_diagram
title Brasil Burger - Deployment Architecture

rectangle "Cloud Platform (Render.com)" {
  rectangle "Frontend Apps" {
    component [Mobile App\n(React Native/Flutter)] as MOBILE
    component [Web App\n(React/Angular)] as WEB
  }
  
  rectangle "API Gateway & Services" {
    component [API Gateway\nNginx/LB] as GATEWAY
    
    rectangle "Microservices" {
      component [Java Spring Boot API\n(REST)\nPort: 8080] as JAVA_API
      component [C# ASP.NET MVC\n(Web)\nPort: 3000] as CSHARP_API
      component [Symfony API\n(Admin/Gestionnaire)\nPort: 8000] as SYMFONY_API
    }
  }
  
  rectangle "Data Layer" {
    database "SQL Server\n(Brasil_Burger)" as SQLSERVER
    database "Redis Cache" as REDIS
  }
  
  rectangle "External Services" {
    component [Payment Gateway\n(WAVE/OM)] as PAYMENT
    component [Notification Service\n(SMS/Email)] as NOTIFY
    component [Mapping Service\n(OpenMap)] as MAPS
  }
}

rectangle "Developer Infrastructure" {
  component [GitHub Repositories\n(4 branches)] as GITHUB
  component [CI/CD Pipeline\n(GitHub Actions)] as CICD
  component [Environment Config\n(Secrets Manager)] as SECRETS
}

MOBILE --> GATEWAY: HTTPS
WEB --> GATEWAY: HTTPS
GATEWAY --> JAVA_API: Routes
GATEWAY --> CSHARP_API: Routes
GATEWAY --> SYMFONY_API: Routes

JAVA_API --> SQLSERVER: JDBC
JAVA_API --> REDIS: Cache
CSHARP_API --> SQLSERVER: EF Core
CSHARP_API --> REDIS: Cache
SYMFONY_API --> SQLSERVER: Doctrine
SYMFONY_API --> REDIS: Cache

JAVA_API --> PAYMENT: HTTP
CSHARP_API --> PAYMENT: HTTP
SYMFONY_API --> PAYMENT: HTTP

JAVA_API --> NOTIFY: HTTP/SMTP
CSHARP_API --> NOTIFY: HTTP/SMTP
SYMFONY_API --> NOTIFY: HTTP/SMTP

MOBILE --> MAPS: HTTP
WEB --> MAPS: HTTP

GITHUB -.-> CICD: Webhooks
CICD --> JAVA_API: Deploy
CICD --> CSHARP_API: Deploy
CICD --> SYMFONY_API: Deploy
CICD -.-> SECRETS: Read Config

note right of GATEWAY
  Load Balancing
  SSL/TLS Termination
  Request Routing
end note

note right of SQLSERVER
  Master Database
  Shared across services
  SQL Server 2019+
  Backup daily
end note

@enduml
